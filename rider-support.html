<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyGo - Support Center</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/sidebar.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f7fc;
            overflow-x: hidden;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-title h1 {
            font-size: 32px;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .page-title p {
            color: #666;
            font-size: 14px;
        }

        .support-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 25px;
        }

        /* Support Sidebar */
        .support-sidebar {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .support-categories {
            margin-bottom: 30px;
        }

        .support-categories h3 {
            color: var(--dark);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .category-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 5px;
            color: #666;
        }

        .category-item:hover {
            background: #f8f9fa;
            color: var(--primary);
        }

        .category-item.active {
            background: var(--primary);
            color: white;
        }

        .category-item i {
            width: 25px;
            margin-right: 10px;
            font-size: 18px;
        }

        .contact-support {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            text-align: center;
        }

        .contact-support h4 {
            margin-bottom: 10px;
            font-size: 18px;
        }

        .contact-support p {
            font-size: 14px;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .contact-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .contact-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Support Main Content */
        .support-main {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .support-section {
            display: none;
        }

        .support-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .section-header h2 {
            font-size: 22px;
            color: var(--dark);
        }

        /* FAQ Section */
        .faq-search {
            position: relative;
            margin-bottom: 30px;
        }

        .faq-search i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .faq-search input {
            width: 100%;
            padding: 15px 15px 15px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .faq-search input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .faq-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .faq-category {
            padding: 8px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9fa;
            color: #666;
            border: 1px solid #e0e0e0;
        }

        .faq-category:hover,
        .faq-category.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .faq-list {
            display: grid;
            gap: 15px;
        }

        .faq-item {
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .faq-item:hover {
            border-color: var(--primary);
        }

        .faq-question {
            padding: 18px 20px;
            background: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--dark);
        }

        .faq-question i {
            color: var(--primary);
            transition: transform 0.3s;
        }

        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s;
            color: #666;
            line-height: 1.6;
        }

        .faq-item.active .faq-answer {
            padding: 0 20px 20px 20px;
            max-height: 200px;
        }

        /* Contact Form */
        .contact-form {
            max-width: 600px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
        }

        /* Live Chat */
        .chat-container {
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .chat-info h3 {
            margin-bottom: 5px;
        }

        .chat-info p {
            font-size: 14px;
            opacity: 0.9;
        }

        .chat-messages {
            height: 300px;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-message {
            display: flex;
            margin-bottom: 20px;
        }

        .chat-message.support {
            justify-content: flex-start;
        }

        .chat-message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.5;
        }

        .chat-message.support .message-content {
            background: white;
            color: var(--dark);
            border-bottom-left-radius: 4px;
        }

        .chat-message.user .message-content {
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 11px;
            margin-top: 5px;
            opacity: 0.7;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #e0e0e0;
        }

        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 25px;
            margin-right: 10px;
            font-size: 14px;
        }

        .chat-input input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .chat-send {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-send:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }

        /* Tickets Section */
        .ticket-list {
            display: grid;
            gap: 15px;
        }

        .ticket-item {
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ticket-item:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .ticket-title {
            font-weight: 600;
            color: var(--dark);
        }

        .ticket-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-open {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-in-progress {
            background: #fff3e0;
            color: #f57c00;
        }

        .status-resolved {
            background: #e8f5e8;
            color: #388e3c;
        }

        .status-closed {
            background: #f5f5f5;
            color: #757575;
        }

        .ticket-info {
            display: flex;
            gap: 20px;
            color: #666;
            font-size: 13px;
            margin-bottom: 10px;
        }

        .ticket-info i {
            margin-right: 5px;
        }

        .ticket-preview {
            color: #666;
            font-size: 14px;
        }

        .new-ticket-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .new-ticket-btn:hover {
            background: var(--secondary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .modal-header h2 {
            color: var(--dark);
        }

        .modal-close {
            cursor: pointer;
            font-size: 24px;
            color: #999;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-actions button {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .save-btn {
            background: var(--primary);
            color: white;
            border: none;
        }

        .save-btn:hover {
            background: var(--secondary);
        }

        .cancel-btn {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #e0e0e0;
        }

        .cancel-btn:hover {
            background: #e9ecef;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success {
            border-left: 4px solid #28a745;
        }

        .toast.error {
            border-left: 4px solid #dc3545;
        }

        .toast.info {
            border-left: 4px solid #17a2b8;
        }

        .toast i {
            font-size: 20px;
        }

        .toast.success i {
            color: #28a745;
        }

        .toast.error i {
            color: #dc3545;
        }

        .toast.info i {
            color: #17a2b8;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .toast-message {
            font-size: 14px;
            color: #666;
        }

        .toast-close {
            cursor: pointer;
            color: #999;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 1024px) {
            .support-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .faq-categories {
                flex-direction: column;
            }
            
            .faq-category {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loadingSpinner" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999;">
        <div class="loading-spinner"></div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Menu Toggle Button -->
    <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="https://img.icons8.com/fluency/48/000000/car.png" alt="EasyGo">
                <span>EasyGo</span>
            </div>
            <button class="sidebar-close" id="sidebarClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="user-info">
            <img src="https://randomuser.me/api/portraits/men/1.jpg" alt="User" class="user-avatar" id="userAvatar">
            <div class="user-details">
                <h4 class="user-name" id="userName">Thabo Nkosi</h4>
                <p class="user-email" id="userEmail">thabo.nkosi@example.com</p>
                <span class="user-badge" id="userBadge">Premium Member</span>
            </div>
        </div>
        
        <div class="sidebar-search">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search...">
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="ride-booking.html" class="nav-link">
                    <i class="fas fa-car"></i>
                    <span>Book a Ride</span>
                    <span class="nav-badge">New</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="ride-history.html" class="nav-link">
                    <i class="fas fa-history"></i>
                    <span>Ride History</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="rider-payments.html" class="nav-link">
                    <i class="fas fa-wallet"></i>
                    <span>Payments</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="rider-profile.html" class="nav-link">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="rider-notifications.html" class="nav-link">
                    <i class="fas fa-bell"></i>
                    <span>Notifications</span>
                    <span class="nav-badge notification-dot"></span>
                </a>
            </li>
            <li class="nav-item">
                <a href="rider-support.html" class="nav-link active">
                    <i class="fas fa-headset"></i>
                    <span>Support</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="rider-settings.html" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </li>
            <li class="nav-item logout-item">
                <a href="javascript:void(0)" class="nav-link" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>
        </ul>

        <div class="sidebar-footer">
            <div class="sidebar-progress">
                <div class="progress-info">
                    <span>Ride Points</span>
                    <span>750/1000</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                </div>
            </div>
            <div class="sidebar-help" onclick="window.location.href='rider-support.html'">
                <i class="fas fa-question-circle"></i>
                <span>Need Help?</span>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <div class="page-title">
                    <h1>Support Center</h1>
                    <p>Get help with your rides, payments, and account</p>
                </div>
            </div>

            <!-- Support Grid -->
            <div class="support-grid">
                <!-- Support Sidebar -->
                <div class="support-sidebar">
                    <div class="support-categories">
                        <h3>Help Topics</h3>
                        <div class="category-item active" onclick="switchSupportSection('faq', this)">
                            <i class="fas fa-question-circle"></i>
                            <span>FAQ</span>
                        </div>
                        <div class="category-item" onclick="switchSupportSection('contact', this)">
                            <i class="fas fa-envelope"></i>
                            <span>Contact Us</span>
                        </div>
                        <div class="category-item" onclick="switchSupportSection('chat', this)">
                            <i class="fas fa-comments"></i>
                            <span>Live Chat</span>
                        </div>
                        <div class="category-item" onclick="switchSupportSection('tickets', this)">
                            <i class="fas fa-ticket-alt"></i>
                            <span>My Tickets</span>
                        </div>
                    </div>

                    <div class="contact-support">
                        <h4>Emergency Support</h4>
                        <p>For urgent issues, our support team is available 24/7</p>
                        <button class="contact-btn" onclick="startLiveChat()">
                            <i class="fas fa-headset"></i> Start Live Chat
                        </button>
                        <div style="margin-top: 15px; font-size: 14px;">
                            <i class="fas fa-phone"></i> Call: 0800 123 4567
                        </div>
                    </div>
                </div>

                <!-- Support Main Content -->
                <div class="support-main">
                    <!-- FAQ Section -->
                    <div id="faqSection" class="support-section active">
                        <div class="section-header">
                            <h2>Frequently Asked Questions</h2>
                        </div>

                        <div class="faq-search">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Search FAQs..." onkeyup="searchFAQ(this.value)">
                        </div>

                        <div class="faq-categories">
                            <span class="faq-category active" onclick="filterFAQ('all', this)">All</span>
                            <span class="faq-category" onclick="filterFAQ('rides', this)">Rides</span>
                            <span class="faq-category" onclick="filterFAQ('payments', this)">Payments</span>
                            <span class="faq-category" onclick="filterFAQ('account', this)">Account</span>
                            <span class="faq-category" onclick="filterFAQ('safety', this)">Safety</span>
                        </div>

                        <div class="faq-list" id="faqList">
                            <!-- FAQs will be loaded here -->
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div id="contactSection" class="support-section">
                        <div class="section-header">
                            <h2>Contact Us</h2>
                        </div>

                        <div class="contact-form">
                            <form onsubmit="submitContactForm(event)">
                                <div class="form-group">
                                    <label>Subject</label>
                                    <select id="contactSubject" required>
                                        <option value="">Select a topic</option>
                                        <option value="ride">Ride Issue</option>
                                        <option value="payment">Payment Problem</option>
                                        <option value="account">Account Issue</option>
                                        <option value="driver">Driver Complaint</option>
                                        <option value="feedback">Feedback</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Ride ID (Optional)</label>
                                    <input type="text" id="rideId" placeholder="e.g., RIDE123456">
                                </div>

                                <div class="form-group">
                                    <label>Message</label>
                                    <textarea id="contactMessage" rows="6" placeholder="Describe your issue in detail..." required></textarea>
                                </div>

                                <div class="form-group">
                                    <label>Attachments</label>
                                    <input type="file" id="attachments" multiple accept="image/*,.pdf">
                                </div>

                                <button type="submit" class="submit-btn">
                                    <i class="fas fa-paper-plane"></i> Submit Request
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Live Chat Section -->
                    <div id="chatSection" class="support-section">
                        <div class="section-header">
                            <h2>Live Chat Support</h2>
                        </div>

                        <div class="chat-container">
                            <div class="chat-header">
                                <div class="chat-avatar">
                                    <i class="fas fa-headset"></i>
                                </div>
                                <div class="chat-info">
                                    <h3>EasyGo Support</h3>
                                    <p>Typically replies in a few minutes</p>
                                </div>
                            </div>

                            <div class="chat-messages" id="chatMessages">
                                <!-- Chat messages will be loaded here -->
                            </div>

                            <div class="chat-input">
                                <input type="text" id="chatInput" placeholder="Type your message..." onkeypress="handleChatKeyPress(event)">
                                <button class="chat-send" onclick="sendChatMessage()">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tickets Section -->
                    <div id="ticketsSection" class="support-section">
                        <div class="section-header">
                            <h2>My Support Tickets</h2>
                            <button class="new-ticket-btn" onclick="showNewTicketModal()">
                                <i class="fas fa-plus"></i> New Ticket
                            </button>
                        </div>

                        <div class="ticket-list" id="ticketList">
                            <!-- Tickets will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Ticket Modal -->
    <div class="modal" id="newTicketModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Support Ticket</h2>
                <span class="modal-close" onclick="closeModal('newTicketModal')">&times;</span>
            </div>

            <form onsubmit="createTicket(event)">
                <div class="form-group">
                    <label>Subject</label>
                    <input type="text" id="ticketSubject" placeholder="Brief summary of your issue" required>
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <select id="ticketCategory" required>
                        <option value="">Select category</option>
                        <option value="ride">Ride Issue</option>
                        <option value="payment">Payment Problem</option>
                        <option value="account">Account Issue</option>
                        <option value="driver">Driver Complaint</option>
                        <option value="technical">Technical Problem</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Priority</label>
                    <select id="ticketPriority" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="urgent">Urgent</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="ticketDescription" rows="5" placeholder="Describe your issue in detail..." required></textarea>
                </div>

                <div class="form-group">
                    <label>Attachments</label>
                    <input type="file" id="ticketAttachments" multiple>
                </div>

                <div class="modal-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('newTicketModal')">Cancel</button>
                    <button type="submit" class="save-btn">Create Ticket</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ticket Details Modal -->
    <div class="modal" id="ticketDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ticket Details</h2>
                <span class="modal-close" onclick="closeModal('ticketDetailsModal')">&times;</span>
            </div>
            <div id="ticketDetailsContent">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <script src="assets/js/auth.js"></script>
    <script src="assets/js/sidebar.js"></script>
    <script>
        // Sample FAQ data
        const faqs = [
            {
                id: 1,
                category: 'rides',
                question: 'How do I book a ride?',
                answer: 'To book a ride, click on the "Book a Ride" button in the sidebar or dashboard. Enter your pickup location, destination, and select your preferred ride type. Confirm the fare and your ride will be booked instantly.'
            },
            {
                id: 2,
                category: 'rides',
                question: 'How can I cancel a ride?',
                answer: 'You can cancel a ride from the "My Rides" section. Go to Ride History, find your active ride, and click the "Cancel" button. Please note that cancellation fees may apply depending on how close the driver is to your pickup location.'
            },
            {
                id: 3,
                category: 'payments',
                question: 'What payment methods are accepted?',
                answer: 'We accept all major credit/debit cards (Visa, Mastercard, American Express), PayPal, and EasyGo wallet. You can add multiple payment methods in the Payments section.'
            },
            {
                id: 4,
                category: 'payments',
                question: 'How do I get a refund?',
                answer: 'Refunds are processed automatically for cancelled rides or you can request one through the support section. Refunds typically take 3-5 business days to reflect in your account.'
            },
            {
                id: 5,
                category: 'account',
                question: 'How do I change my password?',
                answer: 'You can change your password in the Profile section under Security Settings. Go to Profile → Security Settings → Change Password. Enter your current password and new password to update.'
            },
            {
                id: 6,
                category: 'account',
                question: 'How do I update my personal information?',
                answer: 'Go to your Profile page and click the "Edit Profile" button. You can update your name, email, phone number, and address there.'
            },
            {
                id: 7,
                category: 'safety',
                question: 'What safety measures are in place?',
                answer: 'All drivers undergo background checks, vehicles are regularly inspected, and rides are tracked in real-time. You can also share your ride status with emergency contacts.'
            },
            {
                id: 8,
                category: 'safety',
                question: 'What should I do in an emergency?',
                answer: 'In case of emergency, use the SOS button in the app during an active ride. This will alert our emergency response team and share your location with authorities.'
            }
        ];

        // Sample tickets data
        const tickets = [
            {
                id: 'TKT001',
                subject: 'Issue with recent ride',
                category: 'ride',
                status: 'open',
                priority: 'medium',
                date: '2024-11-19',
                lastUpdate: '2024-11-20',
                description: 'Driver took a longer route than necessary',
                messages: [
                    {
                        sender: 'user',
                        message: 'My driver took a longer route to the airport',
                        date: '2024-11-19 14:30'
                    },
                    {
                        sender: 'support',
                        message: 'We apologize for the inconvenience. We are reviewing the route.',
                        date: '2024-11-19 15:45'
                    }
                ]
            },
            {
                id: 'TKT002',
                subject: 'Payment not processed',
                category: 'payment',
                status: 'in-progress',
                priority: 'high',
                date: '2024-11-18',
                lastUpdate: '2024-11-20',
                description: 'My card was charged but ride was not confirmed',
                messages: [
                    {
                        sender: 'user',
                        message: 'I was charged R350 but the ride failed to book',
                        date: '2024-11-18 09:15'
                    },
                    {
                        sender: 'support',
                        message: 'We are investigating the payment issue',
                        date: '2024-11-18 10:30'
                    }
                ]
            }
        ];

        let currentFAQFilter = 'all';
        let chatMessages = [
            {
                sender: 'support',
                message: 'Hello! How can I help you today?',
                time: '10:00 AM'
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadFAQs();
            loadTickets();
            loadChatMessages();
        });

        // Switch support section
        function switchSupportSection(section, element) {
            // Update category items
            document.querySelectorAll('.category-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');

            // Update sections
            document.querySelectorAll('.support-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(section + 'Section').classList.add('active');
        }

        // Load FAQs
        function loadFAQs() {
            const container = document.getElementById('faqList');
            if (!container) return;

            let filteredFAQs = faqs;
            if (currentFAQFilter !== 'all') {
                filteredFAQs = faqs.filter(f => f.category === currentFAQFilter);
            }

            container.innerHTML = '';
            filteredFAQs.forEach(faq => {
                container.appendChild(createFAQElement(faq));
            });
        }

        // Create FAQ element
        function createFAQElement(faq) {
            const div = document.createElement('div');
            div.className = 'faq-item';

            div.innerHTML = `
                <div class="faq-question" onclick="toggleFAQ(this)">
                    ${faq.question}
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    ${faq.answer}
                </div>
            `;

            return div;
        }

        // Toggle FAQ
        function toggleFAQ(element) {
            const faqItem = element.closest('.faq-item');
            faqItem.classList.toggle('active');
        }

        // Search FAQs
        function searchFAQ(query) {
            const faqItems = document.querySelectorAll('.faq-item');
            query = query.toLowerCase();

            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question').textContent.toLowerCase();
                if (question.includes(query)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Filter FAQs
        function filterFAQ(filter, element) {
            currentFAQFilter = filter;

            document.querySelectorAll('.faq-category').forEach(el => {
                el.classList.remove('active');
            });
            element.classList.add('active');

            loadFAQs();
        }

        // Load tickets
        function loadTickets() {
            const container = document.getElementById('ticketList');
            if (!container) return;

            container.innerHTML = '';
            tickets.forEach(ticket => {
                container.appendChild(createTicketElement(ticket));
            });
        }

        // Create ticket element
        function createTicketElement(ticket) {
            const div = document.createElement('div');
            div.className = 'ticket-item';
            div.onclick = () => showTicketDetails(ticket);

            const date = new Date(ticket.date);
            const formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            div.innerHTML = `
                <div class="ticket-header">
                    <span class="ticket-title">${ticket.subject}</span>
                    <span class="ticket-status status-${ticket.status}">${ticket.status.replace('-', ' ')}</span>
                </div>
                <div class="ticket-info">
                    <span><i class="fas fa-tag"></i> ${ticket.category}</span>
                    <span><i class="fas fa-flag"></i> ${ticket.priority}</span>
                    <span><i class="far fa-calendar"></i> ${formattedDate}</span>
                </div>
                <div class="ticket-preview">
                    ${ticket.description.substring(0, 100)}...
                </div>
            `;

            return div;
        }

        // Show ticket details
        function showTicketDetails(ticket) {
            const modal = document.getElementById('ticketDetailsModal');
            const content = document.getElementById('ticketDetailsContent');

            let messagesHTML = '';
            ticket.messages.forEach(msg => {
                messagesHTML += `
                    <div class="chat-message ${msg.sender}" style="margin-bottom: 15px;">
                        <div class="message-content" style="background: ${msg.sender === 'support' ? 'white' : 'var(--primary)'}; color: ${msg.sender === 'support' ? 'var(--dark)' : 'white'};">
                            ${msg.message}
                            <div class="message-time">${msg.date}</div>
                        </div>
                    </div>
                `;
            });

            content.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">${ticket.subject}</h3>
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                        <span class="ticket-status status-${ticket.status}">${ticket.status}</span>
                        <span style="color: #666;"><i class="fas fa-flag"></i> ${ticket.priority} priority</span>
                    </div>
                </div>

                <div style="background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px;">Conversation</h4>
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${messagesHTML}
                    </div>
                </div>

                <div class="form-group">
                    <label>Add Reply</label>
                    <textarea id="ticketReply" rows="3" placeholder="Type your reply..."></textarea>
                </div>

                <div class="modal-actions">
                    <button class="save-btn" onclick="replyToTicket('${ticket.id}')">
                        <i class="fas fa-reply"></i> Send Reply
                    </button>
                    <button class="cancel-btn" onclick="closeTicket('${ticket.id}')">
                        <i class="fas fa-check"></i> Close Ticket
                    </button>
                </div>
            `;

            modal.classList.add('show');
        }

        // Show new ticket modal
        function showNewTicketModal() {
            document.getElementById('newTicketModal').classList.add('show');
        }

        // Create ticket
        function createTicket(event) {
            event.preventDefault();
            closeModal('newTicketModal');
            showToast('Success', 'Support ticket created successfully!', 'success');
        }

        // Reply to ticket
        function replyToTicket(ticketId) {
            const reply = document.getElementById('ticketReply').value;
            if (!reply) {
                showToast('Error', 'Please enter a reply', 'error');
                return;
            }
            showToast('Success', 'Reply sent successfully!', 'success');
            closeModal('ticketDetailsModal');
        }

        // Close ticket
        function closeTicket(ticketId) {
            if (confirm('Are you sure you want to close this ticket?')) {
                showToast('Success', 'Ticket closed successfully!', 'success');
                closeModal('ticketDetailsModal');
            }
        }

        // Load chat messages
        function loadChatMessages() {
            const container = document.getElementById('chatMessages');
            if (!container) return;

            container.innerHTML = '';
            chatMessages.forEach(msg => {
                container.appendChild(createChatMessageElement(msg));
            });
        }

        // Create chat message element
        function createChatMessageElement(message) {
            const div = document.createElement('div');
            div.className = `chat-message ${message.sender}`;

            div.innerHTML = `
                <div class="message-content">
                    ${message.message}
                    <div class="message-time">${message.time}</div>
                </div>
            `;

            return div;
        }

        // Send chat message
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            // Add user message
            const now = new Date();
            const time = now.getHours() + ':' + now.getMinutes().toString().padStart(2, '0');

            chatMessages.push({
                sender: 'user',
                message: message,
                time: time
            });

            loadChatMessages();

            // Simulate support response
            setTimeout(() => {
                chatMessages.push({
                    sender: 'support',
                    message: 'Thank you for your message. A support agent will assist you shortly.',
                    time: new Date().getHours() + ':' + new Date().getMinutes().toString().padStart(2, '0')
                });
                loadChatMessages();
            }, 1000);

            input.value = '';
        }

        // Handle chat key press
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        // Start live chat
        function startLiveChat() {
            switchSupportSection('chat', document.querySelectorAll('.category-item')[2]);
            showToast('Chat', 'Connecting you to a support agent...', 'info');
        }

        // Submit contact form
        function submitContactForm(event) {
            event.preventDefault();
            showToast('Success', 'Your message has been sent! We\'ll respond within 24 hours.', 'success');
            document.querySelector('form').reset();
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.href = 'login.html';
            }
        }

        // Show toast
        function showToast(title, message, type = 'info') {
            const container = document.getElementById('toastContainer');
            if (!container) return;
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? 'check-circle' : 
                        type === 'error' ? 'exclamation-circle' : 
                        type === 'warning' ? 'exclamation-triangle' : 'info-circle';
            
            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <i class="fas fa-times toast-close" onclick="this.parentElement.remove()"></i>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>