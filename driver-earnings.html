<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earnings - EasyGo Driver</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/sidebar.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .earnings-header {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .earnings-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .earnings-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255,255,255,0.1);
            transform: rotate(45deg);
        }
        
        .earnings-card .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .earnings-card .amount {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .earnings-card .change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .change.positive {
            color: #d4edda;
        }
        
        .change.negative {
            color: #f8d7da;
        }
        
        .time-filter {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 20px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .date-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .date-picker input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-box .value {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-box .label {
            color: #666;
            font-size: 14px;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .chart-placeholder {
            width: 100%;
            height: 300px;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            border-radius: 8px;
            display: flex;
            align-items: flex-end;
            padding: 20px;
            gap: 10px;
        }
        
        .chart-bar {
            flex: 1;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px 4px 0 0;
            min-height: 50px;
            transition: height 0.3s ease;
            position: relative;
        }
        
        .chart-bar:hover {
            opacity: 0.8;
        }
        
        .chart-bar .tooltip {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            display: none;
        }
        
        .chart-bar:hover .tooltip {
            display: block;
        }
        
        .earnings-table {
            background: white;
            padding: 20px;
            border-radius: 12px;
        }
        
        .earnings-table h3 {
            margin-bottom: 20px;
        }
        
        .table-responsive {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            text-align: left;
            padding: 12px;
            background: #f8f9fa;
            color: #666;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        .trip-status {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }
        
        .payment-method {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .payout-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .payout-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .payout-balance {
            font-size: 24px;
            font-weight: bold;
            color: #28a745;
        }
        
        .btn-payout {
            background: #28a745;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-payout:hover {
            background: #218838;
        }
        
        .btn-payout:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .withdrawal-history {
            margin-top: 20px;
        }
        
        .withdrawal-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .withdrawal-item:last-child {
            border-bottom: none;
        }
        
        .withdrawal-status {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        @media (max-width: 768px) {
            .time-filter {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-buttons {
                justify-content: center;
            }
            
            .date-picker {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Menu Toggle Button -->
    <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                          <img src="assets/images/easy-Go-Upsaceld-noBG.png" style="width: 100px;" alt="EasyGo">

            </div>
            <div class="user-info">
                <img src="https://randomuser.me/api/portraits/men/2.jpg" alt="User" class="user-avatar" id="userAvatar">
                <div class="user-details">
                    <h4 class="user-name" id="userName">Sipho Dlamini</h4>
                    <p id="userRole">Driver since 2024</p>
                </div>
            </div>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="driver-dashboard.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/dashboard.png" alt="Dashboard">
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-available-rides.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/car.png" alt="Available Rides">
                    <span>Available Rides</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-current-trip.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/road.png" alt="Current Trip">
                    <span>Current Trip</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-earnings.html" class="nav-link active">
                    <img src="https://img.icons8.com/ios-filled/50/000000/money.png" alt="Earnings">
                    <span>Earnings</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-profile.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/user.png" alt="Profile">
                    <span>Profile</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-vehicle.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/car.png" alt="Vehicle">
                    <span>Vehicle</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-settings.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/settings.png" alt="Settings">
                    <span>Settings</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="driver-support.html" class="nav-link">
                    <img src="https://img.icons8.com/ios-filled/50/000000/support.png" alt="Support">
                    <span>Support</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="javascript:void(0)" class="nav-link" onclick="logout()">
                    <img src="https://img.icons8.com/ios-filled/50/000000/exit.png" alt="Logout">
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <h1>Earnings</h1>
            
            <!-- Payout Section -->
            <div class="payout-section">
                <div class="payout-info">
                    <div>
                        <div class="label">Available for Withdrawal</div>
                        <div class="payout-balance" id="availableBalance">R 2,450.50</div>
                    </div>
                    <button class="btn-payout" onclick="requestPayout()">
                        <i class="fas fa-money-bill-wave"></i> Request Payout
                    </button>
                </div>
                
                <div class="withdrawal-history" id="withdrawalHistory">
                    <h4>Recent Withdrawals</h4>
                    <div class="withdrawal-item">
                        <div>
                            <div>Feb 15, 2026</div>
                            <div>Bank Transfer • FNB ********1234</div>
                        </div>
                        <div>
                            <div class="withdrawal-status status-completed">Completed</div>
                            <div>R 1,500.00</div>
                        </div>
                    </div>
                    <div class="withdrawal-item">
                        <div>
                            <div>Feb 10, 2026</div>
                            <div>Bank Transfer • FNB ********1234</div>
                        </div>
                        <div>
                            <div class="withdrawal-status status-completed">Completed</div>
                            <div>R 2,000.00</div>
                        </div>
                    </div>
                    <div class="withdrawal-item">
                        <div>
                            <div>Feb 5, 2026</div>
                            <div>Bank Transfer • FNB ********1234</div>
                        </div>
                        <div>
                            <div class="withdrawal-status status-completed">Completed</div>
                            <div>R 1,800.00</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Earnings Header Cards -->
            <div class="earnings-header">
                <div class="earnings-card">
                    <div class="label">Today's Earnings</div>
                    <div class="amount" id="todayEarnings">R 850</div>
                    <div class="change positive">
                        <i class="fas fa-arrow-up"></i> +15% from yesterday
                    </div>
                </div>
                
                <div class="earnings-card" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                    <div class="label">This Week</div>
                    <div class="amount" id="weekEarnings">R 4,250</div>
                    <div class="change positive">
                        <i class="fas fa-arrow-up"></i> +8% from last week
                    </div>
                </div>
                
                <div class="earnings-card" style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);">
                    <div class="label">This Month</div>
                    <div class="amount" id="monthEarnings">R 18,500</div>
                    <div class="change positive">
                        <i class="fas fa-arrow-up"></i> +12% from last month
                    </div>
                </div>
            </div>
            
            <!-- Time Filter -->
            <div class="time-filter">
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterEarnings('day')">Today</button>
                    <button class="filter-btn" onclick="filterEarnings('week')">This Week</button>
                    <button class="filter-btn" onclick="filterEarnings('month')">This Month</button>
                    <button class="filter-btn" onclick="filterEarnings('year')">This Year</button>
                    <button class="filter-btn" onclick="filterEarnings('custom')">Custom</button>
                </div>
                
                <div class="date-picker" id="customDatePicker" style="display: none;">
                    <input type="date" id="startDate" value="2026-02-01">
                    <span>to</span>
                    <input type="date" id="endDate" value="2026-02-17">
                    <button class="btn btn-primary" onclick="applyCustomDate()">Apply</button>
                </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="value" id="totalTrips">45</div>
                    <div class="label">Total Trips</div>
                </div>
                
                <div class="stat-box">
                    <div class="value" id="totalHours">32.5</div>
                    <div class="label">Online Hours</div>
                </div>
                
                <div class="stat-box">
                    <div class="value" id="avgPerTrip">R 94</div>
                    <div class="label">Avg per Trip</div>
                </div>
                
                <div class="stat-box">
                    <div class="value" id="avgPerHour">R 133</div>
                    <div class="label">Avg per Hour</div>
                </div>
                
                <div class="stat-box">
                    <div class="value" id="tips">R 450</div>
                    <div class="label">Tips</div>
                </div>
                
                <div class="stat-box">
                    <div class="value" id="bonuses">R 200</div>
                    <div class="label">Bonuses</div>
                </div>
            </div>
            
            <!-- Chart -->
            <div class="chart-container">
                <h3>Earnings Overview</h3>
                <div class="chart-placeholder" id="earningsChart">
                    <!-- Bars will be dynamically added here -->
                </div>
            </div>
            
            <!-- Earnings Table -->
            <div class="earnings-table">
                <h3>Trip History</h3>
                
                <div class="table-responsive">
                    <table id="earningsTable">
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Rider</th>
                                <th>Pickup → Dropoff</th>
                                <th>Distance</th>
                                <th>Duration</th>
                                <th>Fare</th>
                                <th>Your Earnings</th>
                                <th>Status</th>
                                <th>Payment</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Table rows will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/sidebar.js"></script>
    <script>
        // Mock data for earnings
        const mockTrips = [
            {
                id: 1,
                date: '2026-02-17',
                time: '10:30 AM',
                rider: 'Thabo Nkosi',
                pickup: 'Sandton City',
                dropoff: 'OR Tambo Airport',
                distance: 25,
                duration: 35,
                fare: 290,
                earnings: 217.50,
                status: 'completed',
                payment: 'Credit Card'
            },
            {
                id: 2,
                date: '2026-02-17',
                time: '09:15 AM',
                rider: 'Nomvula Mkhize',
                pickup: 'Rosebank Mall',
                dropoff: 'Fourways Mall',
                distance: 15,
                duration: 25,
                fare: 180,
                earnings: 135,
                status: 'completed',
                payment: 'Cash'
            },
            {
                id: 3,
                date: '2026-02-16',
                time: '08:45 PM',
                rider: 'David Smith',
                pickup: 'Melrose Arch',
                dropoff: 'Lanseria Airport',
                distance: 35,
                duration: 45,
                fare: 450,
                earnings: 337.50,
                status: 'completed',
                payment: 'Credit Card'
            },
            {
                id: 4,
                date: '2026-02-16',
                time: '06:30 PM',
                rider: 'Zanele Khumalo',
                pickup: 'Mall of Africa',
                dropoff: 'Waterfall City',
                distance: 8,
                duration: 15,
                fare: 95,
                earnings: 71.25,
                status: 'completed',
                payment: 'EasyGo Wallet'
            },
            {
                id: 5,
                date: '2026-02-16',
                time: '04:20 PM',
                rider: 'Sipho Zulu',
                pickup: 'Montecasino',
                dropoff: 'Nelson Mandela Square',
                distance: 12,
                duration: 20,
                fare: 150,
                earnings: 112.50,
                status: 'cancelled',
                payment: 'Cash'
            },
            {
                id: 6,
                date: '2026-02-16',
                time: '02:15 PM',
                rider: 'Linda Ngubane',
                pickup: 'University of Johannesburg',
                dropoff: 'Soweto',
                distance: 18,
                duration: 30,
                fare: 210,
                earnings: 157.50,
                status: 'completed',
                payment: 'Credit Card'
            }
        ];
        
        function loadUserData() {
            const user = getCurrentUser();
            if (user) {
                document.getElementById('userName').textContent = user.name;
                document.getElementById('userRole').textContent = 'Driver since 2024';
                
                // Update stats based on user
                if (user.name === 'Sipho Dlamini') {
                    document.getElementById('todayEarnings').textContent = 'R 850';
                    document.getElementById('weekEarnings').textContent = 'R 4,250';
                    document.getElementById('monthEarnings').textContent = 'R 18,500';
                } else if (user.name === 'Nomsa Zwane') {
                    document.getElementById('todayEarnings').textContent = 'R 920';
                    document.getElementById('weekEarnings').textContent = 'R 4,850';
                    document.getElementById('monthEarnings').textContent = 'R 21,200';
                }
            }
        }
        
        function loadEarningsTable() {
            const tbody = document.querySelector('#earningsTable tbody');
            
            tbody.innerHTML = mockTrips.map(trip => {
                const statusClass = trip.status === 'completed' ? 'status-completed' : 'status-cancelled';
                
                return `
                    <tr>
                        <td>${trip.date}<br><small>${trip.time}</small></td>
                        <td>${trip.rider}</td>
                        <td>${trip.pickup}<br><small>→ ${trip.dropoff}</small></td>
                        <td>${trip.distance} km</td>
                        <td>${trip.duration} min</td>
                        <td>R ${trip.fare}</td>
                        <td><strong>R ${trip.earnings.toFixed(2)}</strong></td>
                        <td><span class="trip-status ${statusClass}">${trip.status}</span></td>
                        <td>${trip.payment}</td>
                    </tr>
                `;
            }).join('');
        }
        
        function loadChart() {
            const chart = document.getElementById('earningsChart');
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const earnings = [450, 680, 520, 710, 850, 920, 780];
            
            chart.innerHTML = days.map((day, index) => {
                const height = (earnings[index] / 1000) * 250; // Max height 250px
                return `
                    <div class="chart-bar" style="height: ${height}px;">
                        <div class="tooltip">R ${earnings[index]}</div>
                        <div style="text-align: center; margin-top: 10px; color: #666;">${day}</div>
                    </div>
                `;
            }).join('');
        }
        
        function filterEarnings(period) {
            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide custom date picker
            const datePicker = document.getElementById('customDatePicker');
            if (period === 'custom') {
                datePicker.style.display = 'flex';
            } else {
                datePicker.style.display = 'none';
            }
            
            // Update chart and stats based on period
            // This would normally fetch data from server
            if (period === 'day') {
                updateStatsForPeriod('day');
            } else if (period === 'week') {
                updateStatsForPeriod('week');
            } else if (period === 'month') {
                updateStatsForPeriod('month');
            }
        }
        
        function updateStatsForPeriod(period) {
            // Demo function to update stats
            if (period === 'day') {
                document.getElementById('totalTrips').textContent = '8';
                document.getElementById('totalHours').textContent = '5.5';
                document.getElementById('avgPerTrip').textContent = 'R 106';
                document.getElementById('avgPerHour').textContent = 'R 155';
                document.getElementById('tips').textContent = 'R 85';
                document.getElementById('bonuses').textContent = 'R 0';
            } else if (period === 'week') {
                document.getElementById('totalTrips').textContent = '45';
                document.getElementById('totalHours').textContent = '32.5';
                document.getElementById('avgPerTrip').textContent = 'R 94';
                document.getElementById('avgPerHour').textContent = 'R 133';
                document.getElementById('tips').textContent = 'R 450';
                document.getElementById('bonuses').textContent = 'R 200';
            } else if (period === 'month') {
                document.getElementById('totalTrips').textContent = '189';
                document.getElementById('totalHours').textContent = '142';
                document.getElementById('avgPerTrip').textContent = 'R 98';
                document.getElementById('avgPerHour').textContent = 'R 130';
                document.getElementById('tips').textContent = 'R 1,850';
                document.getElementById('bonuses').textContent = 'R 850';
            }
        }
        
        function applyCustomDate() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            alert(`Fetching earnings from ${startDate} to ${endDate}`);
            // This would fetch data from server
        }
        
        function requestPayout() {
            const balance = document.getElementById('availableBalance').textContent;
            const amount = parseFloat(balance.replace('R ', ''));
            
            if (amount < 50) {
                alert('Minimum payout amount is R 50');
                return;
            }
            
            if (confirm(`Request payout of ${balance} to your bank account?`)) {
                alert('Payout requested successfully! It will be processed within 1-2 business days.');
                
                // Add to withdrawal history
                const history = document.getElementById('withdrawalHistory');
                const today = new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                
                const newWithdrawal = `
                    <div class="withdrawal-item">
                        <div>
                            <div>${today}</div>
                            <div>Bank Transfer • FNB ********1234</div>
                        </div>
                        <div>
                            <div class="withdrawal-status status-pending">Pending</div>
                            <div>${balance}</div>
                        </div>
                    </div>
                `;
                
                history.innerHTML = history.innerHTML + newWithdrawal;
                
                // Update available balance
                document.getElementById('availableBalance').textContent = 'R 0.00';
            }
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            loadUserData();
            loadEarningsTable();
            loadChart();
        });
    </script>
</body>
</html>